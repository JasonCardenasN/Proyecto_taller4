{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Yughi/Desktop/Proyecto_taller4/app/api/ligas/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { GoogleSpreadsheet } from 'google-spreadsheet';\r\nimport { JWT } from 'google-auth-library';\r\n\r\nasync function getDoc() {\r\n  try {\r\n    const serviceAccountAuth = new JWT({\r\n      email: process.env.GOOGLE_SHEETS_CLIENT_EMAIL,\r\n      key: process.env.GOOGLE_SHEETS_PRIVATE_KEY!.replace(/\\\\n/g, '\\n'),\r\n      scopes: ['https://www.googleapis.com/auth/spreadsheets'],\r\n    });\r\n\r\n    const doc = new GoogleSpreadsheet(process.env.GOOGLE_SHEET_ID!, serviceAccountAuth);\r\n    await doc.loadInfo();\r\n    return doc;\r\n  } catch (error) {\r\n    console.error(\"Error en autenticaciÃ³n o carga de Google Sheet:\", error);\r\n    throw new Error(\"Failed to authenticate with Google Sheets\");\r\n  }\r\n}\r\n\r\nexport async function GET() {\r\n  try {\r\n    const doc = await getDoc();\r\n    const sheet = doc.sheetsByIndex[0];\r\n    const rows = await sheet.getRows();\r\n\r\n    const headers = sheet.headerValues;\r\n\r\n    const data = rows.map((row, index) => ({\r\n      rowIndex: index,\r\n      ...row.toObject(),\r\n    }));\r\n\r\n    return NextResponse.json({ headers, data });\r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\r\n    return NextResponse.json({ error: \"Failed to fetch data\", details: errorMessage }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const newRowData = await request.json();\r\n    const doc = await getDoc();\r\n    const sheet = doc.sheetsByIndex[0];\r\n\r\n    const newRow = await sheet.addRow(newRowData);\r\n\r\n    return NextResponse.json({ success: true, row: newRow.toObject() }, { status: 201 });\r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\r\n    return NextResponse.json({ error: \"Failed to add row\", details: errorMessage }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function PUT(request: Request) {\r\n  try {\r\n    const { rowIndex, data } = await request.json();\r\n\r\n    if (typeof rowIndex !== 'number' || !data) {\r\n      return NextResponse.json({ error: \"Invalid request body\" }, { status: 400 });\r\n    }\r\n\r\n    const doc = await getDoc();\r\n    const sheet = doc.sheetsByIndex[0];\r\n    const rows = await sheet.getRows();\r\n\r\n    if (rowIndex >= rows.length) {\r\n      return NextResponse.json({ error: \"Row index out of bounds\" }, { status: 404 });\r\n    }\r\n\r\n    const rowToUpdate = rows[rowIndex];\r\n\r\n    let changed = false;\r\n    for (const header of sheet.headerValues) {\r\n      if (data[header] !== undefined) {\r\n        if (rowToUpdate.get(header) !== data[header]) {\r\n          rowToUpdate.set(header, data[header]);\r\n          changed = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (changed) {\r\n      await rowToUpdate.save();\r\n    }\r\n\r\n    return NextResponse.json({ success: true, updatedRow: rowToUpdate.toObject() });\r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\r\n    return NextResponse.json({ error: \"Failed to update row\", details: errorMessage }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function DELETE(request: Request) {\r\n  try {\r\n    const { rowIndex } = await request.json();\r\n\r\n    if (typeof rowIndex !== 'number') {\r\n      return NextResponse.json({ error: \"Invalid request body\" }, { status: 400 });\r\n    }\r\n\r\n    const doc = await getDoc();\r\n    const sheet = doc.sheetsByIndex[0];\r\n    const rows = await sheet.getRows();\r\n\r\n    if (rowIndex >= rows.length) {\r\n      return NextResponse.json({ error: \"Row index out of bounds\" }, { status: 404 });\r\n    }\r\n\r\n    await rows[rowIndex].delete();\r\n\r\n    return NextResponse.json({ success: true, message: \"Row deleted\" });\r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\r\n    return NextResponse.json({ error: \"Failed to delete row\", details: errorMessage }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}